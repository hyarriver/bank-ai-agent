# Zeabur 内部域名配置指南

## 内部域名说明

`bank-ai-agent.zeabur.internal` 是 Zeabur 的内部服务发现域名，用于同一项目内服务之间的通信。

## 重要提示

⚠️ **`.zeabur.internal` 域名只能在同一 Zeabur 项目内的服务之间使用，不能从浏览器直接访问。**

## 配置方案

### 方案 1：使用 Zeabur 路由（推荐）

如果前端和后端在同一个项目中，Zeabur 可能已经配置了路由。检查：

1. **查看服务路由配置**
   - 在 Zeabur Dashboard 中查看服务设置
   - 检查是否有路由配置

2. **使用相对路径**
   - 如果路由已配置，前端可以使用相对路径
   - 环境变量设置为：`VITE_WS_URL=/ws/chat`

### 方案 2：使用公共域名

如果前端需要从浏览器访问后端，必须使用公共域名：

1. **获取后端公共域名**
   - 在 Zeabur Dashboard 中找到后端服务
   - 复制公共域名（格式：`backend-xxx.zeabur.app`）

2. **配置前端环境变量**
   ```
   VITE_WS_URL=wss://backend-xxx.zeabur.app/ws/chat
   ```

### 方案 3：配置 Zeabur 路由规则

如果 Zeabur 支持，可以配置路由：

- 前端服务：处理所有 `/` 请求
- 后端服务：处理 `/api/*` 和 `/ws/*` 请求

这样前端可以使用相对路径：`/ws/chat`

## 当前情况分析

你提供的 `bank-ai-agent.zeabur.internal` 可能是：

1. **后端服务的内部域名**
   - 前端无法直接使用（浏览器无法解析 `.internal` 域名）
   - 需要找到后端的公共域名

2. **项目级别的内部域名**
   - 可能需要通过 Zeabur 的路由配置来使用

## 解决步骤

### 步骤 1：确认后端公共域名

在 Zeabur Dashboard：
1. 进入后端服务
2. 查看 "Domains" 或 "URL" 部分
3. 找到公共域名（格式：`xxx.zeabur.app`）

### 步骤 2：配置前端环境变量

使用后端公共域名：

```
VITE_WS_URL=wss://后端公共域名/ws/chat
```

### 步骤 3：验证配置

1. 重新部署前端
2. 打开浏览器控制台
3. 应该看到：`使用环境变量中的完整 WebSocket URL: wss://...`
4. 检查连接状态

## 如果找不到公共域名

1. **检查服务是否已分配域名**
   - 在 Zeabur 中，服务可能需要手动添加域名
   - 或者使用自动分配的域名

2. **联系 Zeabur 支持**
   - 如果服务没有公共域名，可能需要配置

## 快速检查

请提供：
1. 后端服务的公共域名（不是 `.internal` 域名）
2. 前端服务的域名（你提到的是 `hy-bank-ai-agent.zeabur.app`）

有了这些信息，我可以帮你配置正确的 WebSocket URL。

